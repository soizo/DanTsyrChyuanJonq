<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Words">
    <meta name="theme-color" content="#F5F4F0">
    <title>Dan Tsyr Chyuan Jonq</title>
    <link rel="preconnect" href="https://fontsapi.zeoseven.com" crossorigin>
    <link rel="stylesheet" href="https://fontsapi.zeoseven.com/214/main/result.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>
            <img src="assets/title.png" alt="Dan Tsyr Chyuan Jonq">
        </h1>

        <!-- Mode Switch -->
        <div class="mode-switch">
            <label>Daily</label>
            <div class="toggle" id="modeToggle" tabindex="0">
                <div class="toggle-slider"></div>
            </div>
            <label>Full</label>
        </div>

        <!-- Status Indicator -->
        <div class="status-indicator" id="statusIndicator"></div>

        <!-- Add Word Form -->
        <div class="add-form">
            <div class="form-row">
                <label>Word</label>
                <input type="text" id="wordInput" required>
            </div>
            <div class="form-row">
                <label>Meaning</label>
                <input type="text" id="meaningInput">
            </div>
            <div class="form-grid-3">
                <div class="form-row">
                    <label>POS</label>
                    <div class="dropdown-container pos-selector" id="posSelector">
                        <div class="dropdown-selected pos-selected" id="posSelected">
                            <span class="pos-placeholder">Select...</span>
                        </div>
                        <div class="dropdown-menu pos-dropdown" id="posDropdown">
                            <label class="dropdown-option pos-option" data-value="n" onclick="togglePosOption(this, event)">n.</label>
                            <label class="dropdown-option pos-option" data-value="v" onclick="togglePosOption(this, event)">v.</label>
                            <label class="dropdown-option pos-option" data-value="adj" onclick="togglePosOption(this, event)">adj.</label>
                            <label class="dropdown-option pos-option" data-value="adv" onclick="togglePosOption(this, event)">adv.</label>
                            <label class="dropdown-option pos-option" data-value="prep" onclick="togglePosOption(this, event)">prep.</label>
                            <label class="dropdown-option pos-option" data-value="conj" onclick="togglePosOption(this, event)">conj.</label>
                            <label class="dropdown-option pos-option" data-value="pron" onclick="togglePosOption(this, event)">pron.</label>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <label>Weight</label>
                    <div class="dropdown-container weight-selector" id="weightSelector">
                        <div class="dropdown-selected weight-selected" id="weightSelected">
                            3
                        </div>
                        <div class="dropdown-menu weight-dropdown" id="weightDropdown">
                            <label class="dropdown-option weight-option" data-value="5" onclick="setWeightOption(this, event)">5</label>
                            <label class="dropdown-option weight-option" data-value="4" onclick="setWeightOption(this, event)">4</label>
                            <label class="dropdown-option weight-option selected" data-value="3" onclick="setWeightOption(this, event)">3</label>
                            <label class="dropdown-option weight-option" data-value="2" onclick="setWeightOption(this, event)">2</label>
                            <label class="dropdown-option weight-option" data-value="1" onclick="setWeightOption(this, event)">1</label>
                            <label class="dropdown-option weight-option" data-value="0" onclick="setWeightOption(this, event)">0</label>
                            <label class="dropdown-option weight-option" data-value="-1" onclick="setWeightOption(this, event)">-1</label>
                            <label class="dropdown-option weight-option" data-value="-2" onclick="setWeightOption(this, event)">-2</label>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <label>Date</label>
                    <input type="date" id="dateInput">
                </div>
            </div>
            <button class="btn-primary" onclick="addWord()">Add</button>
        </div>

        <!-- Data Controls -->
        <div class="data-controls">
            <button class="btn-secondary" onclick="manualSave()">Save</button>
            <button class="btn-secondary" onclick="exportData()">Export</button>
            <button class="btn-secondary" onclick="document.getElementById('importFile').click()">Import</button>
            <button class="btn-secondary" id="selectModeBtn" onclick="toggleSelectMode()">Select Words</button>
            <button class="btn-secondary" onclick="openSettingsModal()">Settings</button>
            <input type="file" id="importFile" accept=".json" onchange="importData(event)">
        </div>

        <!-- Batch Operations Toolbar (hidden by default) -->
        <div id="batchToolbar" class="batch-toolbar">
            <div class="batch-toolbar-section">
                <div class="batch-toolbar-label">Select:</div>
                <button class="btn-batch" onclick="selectAll()">All</button>
                <button class="btn-batch" onclick="selectNone()">None</button>
                <button class="btn-batch" onclick="selectInvert()">Invert</button>
            </div>
            <div class="batch-toolbar-section">
                <div class="batch-toolbar-label">By Weight:</div>
                <button class="btn-batch" onclick="selectByWeight(5, 10)">5+</button>
                <button class="btn-batch" onclick="selectByWeight(3, 4)">3-4</button>
                <button class="btn-batch" onclick="selectByWeight(1, 2)">1-2</button>
                <button class="btn-batch" onclick="selectByWeight(0, 0)">0</button>
                <button class="btn-batch" onclick="selectByWeight(-2, -1)">Mastered</button>
            </div>
            <div class="batch-toolbar-section">
                <div class="batch-toolbar-label">Actions:</div>
                <button class="btn-batch btn-batch-up" onclick="batchAdjustWeight(1)" id="batchUpBtn" disabled>Up</button>
                <button class="btn-batch btn-batch-down" onclick="batchAdjustWeight(-1)" id="batchDownBtn" disabled>Down</button>
                <button class="btn-batch btn-batch-delete" onclick="batchDeleteConfirm()" id="batchDeleteBtn" disabled>Delete</button>
            </div>
        </div>

        <!-- Word List -->
        <div id="wordList"></div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">Edit Word</div>
            <div class="form-row">
                <label>Word</label>
                <input type="text" id="editWordInput">
            </div>
            <div class="form-row">
                <label>Meaning</label>
                <input type="text" id="editMeaningInput">
            </div>
            <div class="form-grid-3">
                <div class="form-row">
                    <label>POS</label>
                    <div class="dropdown-container pos-selector" id="editPosSelector">
                        <div class="dropdown-selected pos-selected" id="editPosSelected">
                            <span class="pos-placeholder">Select...</span>
                        </div>
                        <div class="dropdown-menu pos-dropdown" id="editPosDropdown">
                            <label class="dropdown-option pos-option" data-value="n" onclick="toggleEditPosOption(this, event)">n.</label>
                            <label class="dropdown-option pos-option" data-value="v" onclick="toggleEditPosOption(this, event)">v.</label>
                            <label class="dropdown-option pos-option" data-value="adj" onclick="toggleEditPosOption(this, event)">adj.</label>
                            <label class="dropdown-option pos-option" data-value="adv" onclick="toggleEditPosOption(this, event)">adv.</label>
                            <label class="dropdown-option pos-option" data-value="prep" onclick="toggleEditPosOption(this, event)">prep.</label>
                            <label class="dropdown-option pos-option" data-value="conj" onclick="toggleEditPosOption(this, event)">conj.</label>
                            <label class="dropdown-option pos-option" data-value="pron" onclick="toggleEditPosOption(this, event)">pron.</label>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <label>Weight</label>
                    <div class="dropdown-container weight-selector" id="editWeightSelector">
                        <div class="dropdown-selected weight-selected" id="editWeightSelected">
                            3
                        </div>
                        <div class="dropdown-menu weight-dropdown" id="editWeightDropdown">
                            <label class="dropdown-option weight-option" data-value="5" onclick="setEditWeightOption(this, event)">5</label>
                            <label class="dropdown-option weight-option" data-value="4" onclick="setEditWeightOption(this, event)">4</label>
                            <label class="dropdown-option weight-option selected" data-value="3" onclick="setEditWeightOption(this, event)">3</label>
                            <label class="dropdown-option weight-option" data-value="2" onclick="setEditWeightOption(this, event)">2</label>
                            <label class="dropdown-option weight-option" data-value="1" onclick="setEditWeightOption(this, event)">1</label>
                            <label class="dropdown-option weight-option" data-value="0" onclick="setEditWeightOption(this, event)">0</label>
                            <label class="dropdown-option weight-option" data-value="-1" onclick="setEditWeightOption(this, event)">-1</label>
                            <label class="dropdown-option weight-option" data-value="-2" onclick="setEditWeightOption(this, event)">-2</label>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <label>Date</label>
                    <input type="date" id="editDateInput">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-primary" onclick="saveEdit()">Save</button>
                <button class="btn-secondary" onclick="closeEditModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">Settings</div>

            <div class="form-row">
                <label>Max Versions</label>
                <input type="number" id="maxVersionsInput" min="10" max="200" value="50">
            </div>

            <div class="form-row">
                <label>Version History</label>
                <button class="btn-secondary" onclick="openHistoryModal()" style="margin-top: 0;">View History</button>
            </div>

            <div class="modal-actions">
                <button class="btn-primary" onclick="saveSettings()">Save</button>
                <button class="btn-secondary" onclick="closeSettingsModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="historyModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">Version History</div>

            <div class="version-info">
                <span>Current: <span id="currentVersionIndex">-</span> / <span id="totalVersions">-</span></span>
                <span>Can Undo: <span id="canUndo">-</span> | Can Redo: <span id="canRedo">-</span></span>
            </div>

            <div id="historyList" class="history-list">
                <!-- Dynamically generated version list -->
            </div>

            <div class="modal-actions">
                <button class="btn-secondary" onclick="closeHistoryModal()">Close</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
