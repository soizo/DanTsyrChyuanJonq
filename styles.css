/* ========================================
   MUJI-Inspired Minimal Design System
   ======================================== */

:root {
	/* Simplified Color Palette */
	--color-bg: #F5F4F0;
	--color-surface: #FFFFFF;
	--color-text: #333333;
	--color-text-light: #999999;
	--color-border: #D8D8D8;
	--color-line: #E8E8E8;
	--color-accent: #8B7355;

	/* Spacing */
	--space-xs: 4px;
	--space-sm: 8px;
	--space-md: 16px;
	--space-lg: 24px;
	--space-xl: 32px;
	--space-2xl: 48px;

	/* Radius */
	--radius: 2px;
}

/* ========================================
   Base
   ======================================== */

* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

html {
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

* {
	scrollbar-width: auto;
	scrollbar-color: var(--color-border) transparent;
}

*::-webkit-scrollbar {
	width: 11px;
	height: 11px;
}

*::-webkit-scrollbar-track {
	background: var(--color-border);
	border-radius: 0 !important;
}

*::-webkit-scrollbar-thumb {
	background: var(--color-border);
	border-radius: 0 !important;
	-webkit-border-radius: 0 !important;
	border: 0;
}

*::-webkit-scrollbar-corner {
	background: var(--color-border);
}

*::-webkit-scrollbar-button {
	display: none;
	width: 0;
	height: 0;
}

body {
	font-family: 'Sarasa UI CL', 'Sarasa UI SC', 'Sarasa UI TC', 'Sarasa UI HC',
		'Sarasa UI J', 'Sarasa UI K', 'Sarasa Gothic CL', sans-serif;
	background: var(--color-bg);
	color: var(--color-text);
	line-height: 1.6;
	font-size: 14px;
	font-weight: 500;
	-webkit-text-size-adjust: 100%;
	text-size-adjust: 100%;
	padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

/* ========================================
   Container
   ======================================== */

.container {
	max-width: 680px;
	margin: 0 auto;
	padding: var(--space-2xl) var(--space-lg);
	min-height: 100vh;
}

.workspace-layout {
	display: block;
}

.workspace-left,
.workspace-right {
	min-width: 0;
}

.layout-divider {
	display: none;
}

/* ========================================
   Header
   ======================================== */

h1 {
	margin-bottom: var(--space-2xl);
	text-align: center;
	line-height: 0;
}

h1 img {
	max-width: 280px;
	height: auto;
	display: inline-block;
	vertical-align: middle;
	image-rendering: pixelated;
	image-rendering: crisp-edges;
	-ms-interpolation-mode: nearest-neighbor;
	filter: brightness(0) saturate(100%) invert(21%) sepia(8%) saturate(558%) hue-rotate(314deg) brightness(95%) contrast(87%);
}

/* ========================================
   Mode Switch
   ======================================== */

.mode-switch {
	display: flex;
	justify-content: center;
	align-items: center;
	gap: var(--space-md);
	margin-bottom: calc(var(--space-md) / 4);
	padding: var(--space-md);
	background: var(--color-surface);
	border: 1px solid var(--color-border);
}

@media (min-width: 768px) {
	.workspace-left .mode-switch {
		position: sticky;
		top: env(safe-area-inset-top);
		z-index: 30;
	}
}

@media (max-width: 767px) and (orientation: portrait) {
	.mode-switch {
		z-index: 40;
		width: auto;
		margin-bottom: 0;
	}

	.mode-switch.is-fixed {
		position: fixed;
		top: 0;
		left: 50%;
		transform: translateX(-50%);
		width: min(680px, calc(100vw - (var(--space-md) * 2)));
	}
}

.mode-switch label {
	font-size: 11px;
	color: var(--color-text-light);
	font-weight: 600;
	user-select: none;
	letter-spacing: 0.08em;
	text-transform: uppercase;
}

.toggle {
	position: relative;
	width: 44px;
	height: 24px;
	background: var(--color-border);
	cursor: pointer;
}

.toggle.active {
	background: var(--color-text);
}

.toggle-slider {
	position: absolute;
	top: 2px;
	left: 2px;
	width: 20px;
	height: 20px;
	background: white;
}

.toggle.active .toggle-slider {
	left: 22px;
}

.toggle:focus {
	outline: 2px solid var(--color-text);
	outline-offset: 2px;
}

/* ========================================
   Status Indicator
   ======================================== */

.status-indicator {
	text-align: center;
	font-size: 10px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	color: var(--color-text-light);
	margin-top: 0;
	margin-bottom: calc(var(--space-lg) / 4);
	height: 14px;
	line-height: 14px;
	letter-spacing: 0.02em;
}

.status-indicator.success {
	color: #6B8E23;
}

.status-indicator.error {
	color: #B85450;
}

/* ========================================
   Form
   ======================================== */

.add-form {
	background: var(--color-surface);
	padding: var(--space-lg);
	border: 1px solid var(--color-border);
	margin-bottom: var(--space-lg);
}

.form-row {
	margin-bottom: var(--space-md);
}

.form-row:last-child {
	margin-bottom: 0;
}

.form-row>label {
	display: block;
	font-size: 10px;
	color: var(--color-text-light);
	margin-bottom: var(--space-sm);
	letter-spacing: 0.12em;
	font-weight: 600;
	text-transform: uppercase;
}

input[type="text"],
input[type="date"],
input[type="number"],
select {
	width: 100%;
	min-width: 0;
	padding: var(--space-sm) var(--space-md);
	font-size: 16px;
	line-height: 1.2;
	height: 38px;
	border: 1px solid var(--color-border);
	background: var(--color-bg);
	color: var(--color-text);
	font-family: inherit;
	font-weight: 500;
	border-radius: 0 !important;
	-webkit-appearance: none;
	appearance: none;
	box-sizing: border-box;
	touch-action: manipulation;
}

input[type="checkbox"] {
	-webkit-appearance: none;
	appearance: none;
	width: 16px;
	height: 16px;
	margin: 0;
	border: 1px solid var(--color-border);
	background: var(--color-surface);
	cursor: pointer;
	outline: none;
}

input[type="checkbox"]:checked {
	background: var(--color-text);
	border-color: var(--color-text);
}

input[type="checkbox"]:focus-visible {
	outline: 2px solid var(--color-text);
	outline-offset: 2px;
}

input[type="text"]:focus,
input[type="date"]:focus,
input[type="number"]:focus,
select:focus {
	outline: none;
	border-color: var(--color-text);
	background: var(--color-surface);
}

input[type="number"] {
	appearance: textfield;
	-moz-appearance: textfield;
}

input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
	-webkit-appearance: none;
	margin: 0;
}

#regexFilterInput, input[type="date"]{
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
}

.form-grid {
	display: grid;
	grid-template-columns: 1fr 1fr;
	gap: var(--space-md);
}

.form-grid-3 {
	display: grid;
	grid-template-columns: 1fr 1fr 1fr;
	gap: var(--space-md);
}

.form-grid>.form-row,
.form-grid-3>.form-row {
	min-width: 0;
}

/* ========================================
   Dropdown Base Styles
   ======================================== */

/* Dropdown Container */
.dropdown-container {
	position: relative;
	min-width: 0;
	user-select: none;
	touch-action: manipulation;
}

.dropdown-container.open {
	z-index: 600;
}

/* Dropdown Selected (trigger button) */
.dropdown-selected {
	width: 100%;
	padding: var(--space-sm) var(--space-md);
	font-size: 14px;
	border: 1px solid var(--color-border);
	background: var(--color-bg);
	color: var(--color-text);
	cursor: pointer;
	height: 38px;
	display: flex;
	align-items: center;
	box-sizing: border-box;
}

.dropdown-container.open .dropdown-selected {
	background: var(--color-surface);
}

/* Dropdown Menu */
.dropdown-menu {
	position: absolute;
	top: 100%;
	left: 0;
	right: 0;
	background: var(--color-surface);
	border: 1px solid var(--color-border);
	margin-top: -1px;
	z-index: 700;
	display: none;
	user-select: none;
}

.dropdown-menu.active {
	display: block;
}

/* Dropdown Container Open State */
.dropdown-container.open .dropdown-selected {
	border-top-color: #000000;
	border-right-color: #000000;
	border-left-color: #000000;
}

.dropdown-container.open .dropdown-menu {
	margin-top: 0;
	border-top-color: transparent;
	border-right-color: #000000;
	border-bottom-color: #000000;
	border-left-color: #000000;
}

/* Dropdown Option */
.dropdown-option {
	display: block;
	padding: 6px var(--space-md);
	cursor: pointer;
	font-size: 12px;
	line-height: 1.2;
	color: var(--color-text-light);
	font-weight: 600;
	letter-spacing: 0.08em;
	border-bottom: 1px solid var(--color-line);
	user-select: none;
}

.dropdown-option:last-child {
	border-bottom: none;
}

.dropdown-option:hover {
	background: var(--color-bg);
}

.dropdown-option.selected {
	background: var(--color-text);
	color: var(--color-surface);
}

.dropdown-option.selected:hover {
	background: var(--color-accent);
}

/* ========================================
   POS Selector Specific Styles
   ======================================== */

/* POS Selector */
.pos-selector {
	/* Inherits from .dropdown-container */
}

.pos-selected {
	/* Inherits from .dropdown-selected */
	flex-wrap: nowrap;
	gap: 4px;
	overflow-x: auto;
	overflow-y: hidden;
}

.pos-placeholder {
	color: var(--color-text-light);
	font-size: 14px;
}

.pos-tag {
	display: inline-block;
	padding: 2px 6px;
	background: var(--color-text);
	color: var(--color-surface);
	font-size: 10px;
	font-weight: 600;
	user-select: none;
	text-transform: uppercase;
	letter-spacing: 0.05em;
}

.pos-dropdown {
	/* Inherits from .dropdown-menu */
	max-height: 200px;
	overflow-y: auto;
}

.pos-option {
	/* Inherits from .dropdown-option */
	display: flex;
	align-items: center;
	gap: var(--space-sm);
	line-height: 1;
	text-transform: uppercase;
}

/* ========================================
   Weight Selector Specific Styles
   ======================================== */

/* Weight Selector */
.weight-selector {
	/* Inherits from .dropdown-container */
}

.weight-selected {
	/* Inherits from .dropdown-selected */
}

.weight-dropdown {
	/* Inherits from .dropdown-menu */
}

.weight-option {
	/* Inherits from .dropdown-option */
}

/* ========================================
   Buttons
   ======================================== */

button {
	width: 100%;
	padding: var(--space-md);
	font-size: 11px;
	font-weight: 600;
	border: 1px solid var(--color-border);
	cursor: pointer;
	letter-spacing: 0.1em;
	font-family: inherit;
	margin-top: var(--space-md);
	text-transform: uppercase;
	outline: none;
	border-radius: 0;
	-webkit-appearance: none;
	appearance: none;
	user-select: none;
	touch-action: manipulation;
}

button:focus {
	outline: none;
}

.btn-primary {
	background: var(--color-text);
	color: var(--color-surface);
	border-color: var(--color-text);
}

.btn-primary:active {
	background: var(--color-accent);
	border-color: var(--color-accent);
}

.btn-secondary {
	background: var(--color-surface);
	color: var(--color-text);
	word-break: normal;
	overflow-wrap: normal;
	overflow: hidden;
}

.btn-secondary:active {
	background: var(--color-bg);
}

button:disabled {
	opacity: 0.4;
	cursor: not-allowed;
}

.btn-danger, .is-danger {
	background: #B85450;
	color: var(--color-surface);
	border-color: #B85450;
}

.btn-danger:active, .is-danger:active {
	background: #A24A46;
	border-color: #A24A46;
}

.danger-zone {
	border-top: 1px solid #B85450;
	margin-top: 0.5em;
	padding-top: 1em;
}

.danger-zone > label {
	color: #B85450;
}

/* ========================================
   Data Controls
   ======================================== */

.data-controls {
	display: flex;
	flex-wrap: wrap;
	gap: var(--space-md);
	margin-bottom: var(--space-lg);
}

.data-controls button {
	flex: 1 1 140px;
	width: auto;
	min-width: 0;
	margin-top: 0;
	white-space: normal;
}

/* ========================================
   Batch Operations Toolbar
   ======================================== */

.batch-toolbar {
	display: none;
	flex-direction: column;
	gap: var(--space-sm);
	background: var(--color-surface);
	border: 1px solid var(--color-border);
	padding: var(--space-md);
	margin-bottom: var(--space-2xl);
}

.batch-toolbar-section {
	display: flex;
	flex-direction: column;
	align-items: flex-start;
	gap: var(--space-xs);
}

.batch-toolbar-label {
	font-size: 10px;
	font-weight: 600;
	color: var(--color-text-light);
	letter-spacing: 0.12em;
	text-transform: uppercase;
	width: 100%;
}

.batch-toolbar-controls {
	display: flex;
	align-items: center;
	gap: var(--space-sm);
	width: 100%;
	flex-wrap: nowrap;
	white-space: nowrap;
	overflow-x: auto;
	overflow-y: hidden;
}

.batch-toolbar-controls>* {
	flex: 0 0 auto;
}

.batch-toolbar-section-actions .batch-toolbar-controls {
	flex-wrap: wrap;
	white-space: normal;
	overflow: visible;
}

.batch-actions-date-row {
	display: flex;
	align-items: center;
	gap: var(--space-sm);
	flex: 0 0 100%;
}

.btn-batch {
	flex: 0 0 auto;
	height: auto;
	width: auto;
	min-width: 0;
	padding: 6px var(--space-md);
	font-size: 10px;
	margin-top: 0;
	line-height: 1;
	letter-spacing: 0.02em;
	white-space: nowrap;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	background: var(--color-surface);
	color: var(--color-text);
	border: 1px solid var(--color-border);
}

.btn-batch:not(.btn-batch-add):not(.btn-batch-remove) {
	min-width: 56px;
	aspect-ratio: auto;
}

.btn-batch:hover:not(:disabled) {
	background: var(--color-bg);
}

.btn-batch:active:not(:disabled) {
	background: var(--color-text);
	color: var(--color-surface);
}

.btn-batch:disabled {
	opacity: 0.3;
	cursor: not-allowed;
}

.range-input-group {
	display: flex;
	align-items: center;
	gap: 4px;
	flex-wrap: nowrap;
	flex: 1 1 auto;
	min-width: 0;
}

.range-input {
	width: auto;
	min-width: 4.5ch;
	padding: 4px 6px;
	font-size: 12px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	border: 1px solid var(--color-border);
	background: var(--color-bg);
	color: var(--color-text);
	text-align: center;
	height: 30px;
	min-height: 0;
	margin-top: 0;
	appearance: textfield;
	-moz-appearance: textfield;
	box-sizing: border-box;
}

#weightMinInput,
#weightMaxInput {
	flex: 1 1 0;
	width: 0;
	min-width: 0;
}

.range-input-date {
	font-size: 16px;
	padding: var(--space-sm) var(--space-md);
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	border: 1px solid var(--color-border);
	background: var(--color-bg);
	color: var(--color-text);
	height: 38px;
	min-height: 38px;
	box-sizing: border-box;
}

.batch-actions-date-row>.range-input-date-wrap {
	flex: 1 1 0;
	min-width: 0;
}

#batchSetDateBtn {
	height: 38px;
	min-height: 38px;
	padding: 0 var(--space-sm);
	min-width: 40px;
}

.range-input-date-wrap {
	position: relative;
	display: flex;
}

.range-input-group>.range-input-date,
.range-input-group>.range-input-date-wrap {
	flex: 1 1 0;
	width: 0;
	min-width: 0;
}

.add-form .range-input-date,
.add-form .range-input-date-wrap {
	width: 100%;
}

.range-input-date-wrap>.range-input-date {
	width: 100%;
	min-width: 0;
}

.range-input-date-compact-label {
	position: absolute;
	inset: 0;
	display: flex;
	align-items: center;
	justify-content: center;
	padding: var(--space-sm) var(--space-md);
	font-size: 14px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	font-weight: 500;
	line-height: 1;
	color: var(--color-text);
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	pointer-events: none;
	z-index: 1;
	opacity: 0;
	transition: opacity 0.15s ease;
}

.range-input-date-compact-label.active {
	opacity: 1;
}

.range-input-date.date-icon-only,
.range-input-date.date-compact-value,
.range-input-date.date-special-full {
	position: relative;
	color: transparent;
	-webkit-text-fill-color: transparent;
	caret-color: transparent;
	overflow: hidden;
	cursor: pointer;
}

.range-input-date.date-icon-only {
	background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' fill='none' stroke='%23858585' stroke-width='1.8' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'/%3E%3Cline x1='16' y1='2.5' x2='16' y2='6'/%3E%3Cline x1='8' y1='2.5' x2='8' y2='6'/%3E%3Cline x1='3' y1='10' x2='21' y2='10'/%3E%3C/svg%3E");
	background-repeat: no-repeat;
	background-position: center;
	background-size: 18px 18px;
}

/* Chromium: hide native date text via pseudo-elements */
.range-input-date.date-icon-only::-webkit-datetime-edit,
.range-input-date.date-compact-value::-webkit-datetime-edit,
.range-input-date.date-special-full::-webkit-datetime-edit {
	display: none;
}

.range-input-date.date-icon-only::-webkit-datetime-edit-fields-wrapper,
.range-input-date.date-icon-only::-webkit-datetime-edit-text,
.range-input-date.date-icon-only::-webkit-datetime-edit-month-field,
.range-input-date.date-icon-only::-webkit-datetime-edit-day-field,
.range-input-date.date-icon-only::-webkit-datetime-edit-year-field,
.range-input-date.date-compact-value::-webkit-datetime-edit-fields-wrapper,
.range-input-date.date-compact-value::-webkit-datetime-edit-text,
.range-input-date.date-compact-value::-webkit-datetime-edit-month-field,
.range-input-date.date-compact-value::-webkit-datetime-edit-day-field,
.range-input-date.date-compact-value::-webkit-datetime-edit-year-field,
.range-input-date.date-special-full::-webkit-datetime-edit-fields-wrapper,
.range-input-date.date-special-full::-webkit-datetime-edit-text,
.range-input-date.date-special-full::-webkit-datetime-edit-month-field,
.range-input-date.date-special-full::-webkit-datetime-edit-day-field,
.range-input-date.date-special-full::-webkit-datetime-edit-year-field {
	display: none;
}

/* Chromium: expand calendar picker indicator to full clickable area */
.range-input-date.date-icon-only::-webkit-calendar-picker-indicator,
.range-input-date.date-compact-value::-webkit-calendar-picker-indicator,
.range-input-date.date-special-full::-webkit-calendar-picker-indicator {
	position: absolute;
	inset: 0;
	width: 100%;
	height: 100%;
	margin: 0;
	padding: 0;
	opacity: 0;
	cursor: pointer;
}

/* Safari/iOS: hide native date inner elements */
.range-input-date.date-icon-only::-webkit-date-and-time-value,
.range-input-date.date-compact-value::-webkit-date-and-time-value,
.range-input-date.date-special-full::-webkit-date-and-time-value {
	color: transparent;
	-webkit-text-fill-color: transparent;
}

.range-input::-webkit-outer-spin-button,
.range-input::-webkit-inner-spin-button {
	-webkit-appearance: none;
	margin: 0;
}

.range-separator {
	font-size: 12px;
	color: var(--color-text-light);
	font-weight: 600;
	user-select: none;
}

.btn-batch-add {
	font-size: 14px;
	font-weight: 700;
	width: 38px;
	height: 38px;
	min-width: 38px;
	min-height: 38px;
	padding: 0;
}

.btn-batch-remove {
	font-size: 14px;
	font-weight: 700;
	width: 38px;
	height: 38px;
	min-width: 38px;
	min-height: 38px;
	padding: 0;
}

.btn-batch-add:active:not(:disabled) {
	background: var(--color-text);
	color: var(--color-surface);
}

.btn-batch-remove:active:not(:disabled) {
	background: var(--color-text);
	color: var(--color-surface);
}

.regex-input {
	flex: 1 1 auto;
	width: auto;
	min-width: 80px;
	padding: 6px var(--space-sm);
	font-size: 12px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	border: 1px solid var(--color-border);
	background: var(--color-bg);
	color: var(--color-text);
	margin-top: 0;
	height: 30px;
	min-height: 0;
	box-sizing: border-box;
}

.btn-batch-up {
	color: var(--color-text);
}

.btn-batch-up:active:not(:disabled) {
	background: var(--color-text);
	color: var(--color-surface);
}

.btn-batch-down {
	color: var(--color-text-light);
}

.btn-batch-down:active:not(:disabled) {
	background: var(--color-text);
	color: var(--color-surface);
}

.btn-batch-delete {
	color: #B85450;
}

.btn-batch-delete:active:not(:disabled) {
	background: #B85450;
	color: var(--color-surface);
	border-color: #B85450;
}

/* ========================================
   Word List
   ======================================== */

.word-group {
	margin-bottom: var(--space-2xl);
}

.group-header {
	font-size: 10px;
	font-weight: 600;
	color: var(--color-text-light);
	text-transform: uppercase;
	letter-spacing: 0.12em;
	margin-bottom: var(--space-md);
	padding-bottom: var(--space-sm);
	border-bottom: 1px solid var(--color-line);
}

.word-item {
	background: var(--color-surface);
	padding: var(--space-lg);
	margin-bottom: 1px;
	border: 1px solid var(--color-border);
	border-left: 2px solid var(--color-text);
}

.word-item:last-child {
	margin-bottom: 0;
}

.word-item.mastered {
	opacity: 0.5;
	border-left-color: var(--color-border);
}

.word-item.invalid {
	border-left-color: #B85450;
	background: rgba(184, 84, 80, 0.03);
}

.word-item.select-mode {
	cursor: pointer;
	user-select: none;
}

.word-item.select-mode .word-checkbox {
	pointer-events: none;
}

.word-checkbox {
	cursor: pointer;
	outline: none;
}

.word-checkbox:focus {
	outline: none;
}

.word-header {
	display: flex;
	justify-content: space-between;
	align-items: flex-start;
	margin-bottom: var(--space-sm);
}

.word-title {
	font-size: 16px;
	font-weight: 600;
	letter-spacing: 0.02em;
}

.word-pos {
	display: inline-block;
	padding: 2px 6px;
	background: var(--color-border);
	color: var(--color-text);
	font-size: 9px;
	font-weight: 600;
	letter-spacing: 0.05em;
	text-transform: uppercase;
	margin-left: 4px;
	user-select: none;
	-webkit-user-select: none;
}

.btn-pronounce {
	background: transparent;
	border: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-size: 12px;
	padding: 2px 4px;
	margin: 0 0 0 4px;
	cursor: pointer;
	color: var(--color-text-light);
	opacity: 0.6;
	transition: opacity 0.2s;
	width: auto;
	min-width: auto;
	outline: none;
}

.btn-pronounce:focus {
	outline: none;
}

.btn-pronounce .icon-speaker {
	width: 14px;
	height: 14px;
	display: block;
	transform: translateY(2px);
}

.btn-pronounce:hover {
	opacity: 1;
	color: var(--color-text);
}

.btn-pronounce:active {
	transform: scale(0.9);
}

.word-weight {
	font-size: 14px;
	font-weight: 600;
	color: var(--color-text-light);
	width: 28px;
	height: 28px;
	display: flex;
	align-items: center;
	justify-content: center;
	text-align: center;
	padding: 0;
	background: transparent;
	border: 1px solid var(--color-border);
	letter-spacing: 0;
	flex-shrink: 0;
	user-select: none;
}

.word-weight-text {
	display: inline-block;
}

.word-weight-text.is-squeezed {
	transform: scaleX(0.65);
	letter-spacing: -0.05em;
}

.word-item.invalid .word-weight {
	color: #B85450;
}

.word-meaning {
	font-size: 14px;
	color: var(--color-text-light);
	margin-bottom: var(--space-sm);
	line-height: 1.6;
	font-weight: 500;
}

.word-meta {
	font-size: 9px;
	color: var(--color-text-light);
	margin-bottom: var(--space-md);
	letter-spacing: 0.08em;
	text-transform: uppercase;
}

.word-actions {
	display: flex;
	gap: var(--space-sm);
}

.word-actions button {
	flex: 1;
	padding: var(--space-sm);
	font-size: 9px;
	margin-top: 0;
}

.btn-remember {
	background: var(--color-surface);
	color: var(--color-text);
	border: 1px solid var(--color-border);
}

.btn-remember:active {
	background: var(--color-text);
	color: var(--color-surface);
}

.btn-forget {
	background: var(--color-surface);
	color: var(--color-text-light);
	border: 1px solid var(--color-border);
}

.btn-forget:active {
	background: var(--color-bg);
}

.btn-edit {
	background: var(--color-surface);
	color: var(--color-text-light);
	border: 1px solid var(--color-border);
	flex: 0 0 auto;
	min-width: 50px;
}

.btn-edit:active {
	background: var(--color-text);
	color: var(--color-surface);
}

.btn-delete {
	background: var(--color-surface);
	color: #B85450;
	border: 1px solid var(--color-border);
	flex: 0 0 auto;
	min-width: 50px;
}

.btn-delete:active {
	background: #B85450;
	color: var(--color-surface);
	border-color: #B85450;
}

.btn-delete-mode {
	color: #B85450 !important;
}

.btn-delete-mode:active {
	background: #B85450 !important;
	color: var(--color-surface) !important;
	border-color: #B85450 !important;
}

/* ========================================
   Collapsible
   ======================================== */

.collapsible-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: var(--space-sm) 0;
	cursor: pointer;
	user-select: none;
}

.collapse-icon {
	font-size: 10px;
	color: var(--color-text-light);
	font-weight: 600;
}

.collapsible-content {
	max-height: 0;
	overflow: hidden;
}

.collapsible-content.expanded {
	max-height: 5000px;
}

/* ========================================
   Empty State
   ======================================== */

.empty-state {
	text-align: center;
	padding: var(--space-2xl) var(--space-lg);
	color: var(--color-text-light);
}

.empty-state-icon {
	font-size: 24px;
	margin-bottom: var(--space-md);
	opacity: 0.3;
	font-weight: 400;
}

.empty-state div {
	font-size: 11px;
	letter-spacing: 0.1em;
	font-weight: 600;
	text-transform: uppercase;
}

/* ========================================
   Modal
   ======================================== */

.modal {
	display: none;
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: rgba(0, 0, 0, 0.3);
	z-index: 1000;
	padding: var(--space-lg);
	align-items: center;
	justify-content: center;
}

.modal.active {
	display: flex;
}

.modal-content {
	background: var(--color-surface);
	border: 1px solid var(--color-border);
	max-width: 600px;
	width: 100%;
	padding: var(--space-lg);
	max-height: 90vh;
	overflow-y: auto;
}

#editModal .modal-content {
	overflow: visible;
}

#editModal .dropdown-container.open {
	z-index: 1200;
}

#editModal .dropdown-menu {
	z-index: 1300;
}

.modal-content.modal-large {
	max-width: 700px;
}

.modal-header {
	font-size: 12px;
	font-weight: 600;
	letter-spacing: 0.1em;
	margin-bottom: var(--space-lg);
	text-transform: uppercase;
}

.modal-actions {
	display: flex;
	gap: var(--space-sm);
	margin-top: var(--space-lg);
}

.modal-actions button {
	margin-top: 0;
}

#settingsModal {
	flex-direction: column;
}

#settingsModal .modal-content {
	max-height: calc(90vh - 72px);
	border-bottom: 0;
}

#settingsModal > .modal-actions {
	position: sticky;
	bottom: 0;
	z-index: 10;
	width: 100%;
	max-width: 600px;
	margin-top: 0;
	padding: var(--space-sm) var(--space-sm) calc(var(--space-sm) + env(safe-area-inset-bottom));
	background: var(--color-surface);
	border: 1px solid var(--color-border);
	border-top: 1px solid var(--color-border);
}

.settings-inline-actions {
	display: flex;
	gap: var(--space-sm);
	margin-top: var(--space-sm);
	flex-wrap: wrap;
}

.settings-inline-actions button {
	margin-top: 0;
}

.settings-toggle-list {
	display: flex;
	flex-direction: column;
	gap: var(--space-sm);
}

.settings-toggle-item {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: var(--space-md);
	padding: var(--space-sm) var(--space-md);
	background: var(--color-bg);
	border: 1px solid var(--color-border);
}

.settings-toggle-copy {
	min-width: 0;
	display: flex;
	flex-direction: column;
	gap: 2px;
}

.settings-toggle-title {
	font-size: 11px;
	font-weight: 600;
	letter-spacing: 0.06em;
	text-transform: uppercase;
	color: var(--color-text);
	cursor: pointer;
}

.settings-toggle-desc {
	font-size: 11px;
	line-height: 1.4;
	color: var(--color-text-light);
}

.settings-toggle-desc code {
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	font-size: 10px;
	color: var(--color-text);
}

/* ========================================
   Version History — Registry Editor Style
   ======================================== */

/* Full-screen modal override */
.modal.modal-registry {
	padding: 0;
}

.modal.modal-confirm {
	z-index: 2000;
}

.confirm-modal-content {
	max-width: 460px;
}

.confirm-modal-message {
	font-size: 12px;
	line-height: 1.6;
	white-space: pre-wrap;
	color: var(--color-text);
}

#confirmModalConfirmBtn.btn-primary.is-danger {
	background: #B85450;
	border-color: #B85450;
}

#confirmModalConfirmBtn.btn-primary.is-danger:active {
	background: #A24A46;
	border-color: #A24A46;
}

.registry-container {
	width: 100%;
	height: 100%;
	display: flex;
	flex-direction: column;
	background: var(--color-surface);
	overflow: hidden;
}

/* Toolbar */
.registry-toolbar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 6px var(--space-md);
	background: var(--color-bg);
	border-bottom: 1px solid var(--color-border);
	flex-shrink: 0;
	user-select: none;
}

.registry-title {
	font-size: 11px;
	font-weight: 600;
	letter-spacing: 0.1em;
	text-transform: uppercase;
}

.registry-toolbar-actions {
	display: flex;
	align-items: center;
	gap: var(--space-sm);
}

.registry-info {
	font-size: 9px;
	font-weight: 600;
	letter-spacing: 0.08em;
	text-transform: uppercase;
	color: var(--color-text-light);
}

.registry-toolbar-btn {
	background: none;
	border: 1px solid var(--color-border);
	font-size: 9px;
	font-weight: 600;
	letter-spacing: 0.06em;
	text-transform: uppercase;
	cursor: pointer;
	color: var(--color-text-light);
	padding: 2px 8px;
	line-height: 1;
	width: auto;
	height: 24px;
	margin-top: 0;
	display: inline-flex;
	align-items: center;
	justify-content: center;
}

.registry-toolbar-btn:hover:not(:disabled) {
	background: var(--color-bg);
	color: var(--color-text);
}

.registry-toolbar-btn:disabled {
	opacity: 0.3;
	cursor: not-allowed;
}

#registryDeleteBtn {
	color: #B85450;
}

.registry-close {
	background: none;
	border: none;
	font-size: 18px;
	cursor: pointer;
	color: var(--color-text);
	padding: 0;
	width: 28px;
	height: 28px;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	line-height: 1;
	border-radius: var(--radius);
	margin-top: 0;
}

.registry-close:hover {
	background: var(--color-bg);
}

/* Address bar */
.registry-addressbar {
	display: flex;
	align-items: center;
	padding: 4px var(--space-md);
	background: var(--color-surface);
	border-bottom: 1px solid var(--color-border);
	font-size: 11px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	flex-shrink: 0;
	gap: var(--space-sm);
	color: var(--color-text-light);
	overflow: hidden;
	user-select: none;
}

.registry-path {
	display: flex;
	align-items: center;
	gap: 2px;
	white-space: nowrap;
	overflow-x: auto;
	overflow-y: hidden;
	flex: 1;
}

.registry-path-seg {
	cursor: pointer;
	padding: 2px 6px;
	border-radius: var(--radius);
	transition: background 0.15s, color 0.15s;
	flex-shrink: 0;
}

.registry-path-seg:hover {
	background: var(--color-bg);
	color: var(--color-text);
}

.registry-path-active {
	color: var(--color-text);
	font-weight: 600;
}

.registry-path-sep {
	color: var(--color-text-light);
	opacity: 0.4;
	flex-shrink: 0;
	font-size: 10px;
}

/* Body: tree + preview split */
.registry-body {
	display: flex;
	flex: 1;
	min-height: 0;
	overflow: hidden;
}

/* Tree pane (left) */
.registry-tree-pane {
	width: 30%;
	min-width: 180px;
	max-width: 400px;
	border-right: 1px solid var(--color-border);
	overflow-y: auto;
	overflow-x: hidden;
	background: var(--color-surface);
	flex-shrink: 0;
}

.registry-tree {
	padding: var(--space-xs) 0;
}

/* Tree node */
.tree-node {
	user-select: none;
}

.tree-node-row {
	display: flex;
	align-items: center;
	gap: 2px;
	padding: 3px var(--space-sm);
	padding-right: var(--space-md);
	cursor: pointer;
	font-size: 12px;
	line-height: 1.4;
	white-space: nowrap;
	transition: background 0.1s;
	border-left: 2px solid transparent;
}

.tree-node-row:hover {
	background: var(--color-bg);
}

.tree-node-row.selected {
	background: color-mix(in srgb, var(--color-accent) 15%, var(--color-surface));
	border-left-color: var(--color-accent);
}

.tree-node-row.current-version {
	background: var(--color-text);
	color: var(--color-surface);
}

.tree-node-row.current-version:hover {
	background: var(--color-accent);
}

.tree-node-row.current-version.selected {
	background: var(--color-accent);
	border-left-color: var(--color-surface);
}

/* Fork-depth indent (compact for long linear chains) */
.tree-indent-block {
	display: inline-flex;
	width: calc(var(--tree-fork-depth, 0) * 10px);
	min-width: 0;
	flex-shrink: 0;
}

/* Tree checkbox */
.tree-checkbox {
	width: 12px;
	height: 12px;
	margin: 0 2px 0 0;
	flex-shrink: 0;
	cursor: pointer;
}

/* Expand/collapse toggle */
.tree-toggle {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	width: 16px;
	height: 16px;
	flex-shrink: 0;
	font-size: 8px;
	color: var(--color-text-light);
	cursor: pointer;
}

.tree-toggle.has-children::before {
	content: '▶';
	display: inline-block;
	transition: transform 0.15s;
}

.tree-toggle.expanded::before {
	transform: rotate(90deg);
}

.tree-toggle.no-children {
	visibility: hidden;
}

/* Folder icon */
.tree-icon {
	flex-shrink: 0;
	margin-right: 4px;
	font-size: 13px;
	line-height: 1;
}

/* Node label */
.tree-label {
	flex: 1;
	min-width: 0;
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 8px;
	overflow: hidden;
}

.tree-label-main {
	min-width: 0;
	display: inline-flex;
	align-items: center;
	gap: 6px;
	overflow: hidden;
}

.tree-label-desc {
	min-width: 0;
	overflow: hidden;
	text-overflow: ellipsis;
	font-size: 11px;
}

.tree-label-meta {
	display: inline-flex;
	align-items: center;
	gap: 6px;
	flex-shrink: 0;
}

.tree-label-branch {
	font-size: 8px;
	letter-spacing: 0.04em;
	text-transform: uppercase;
	color: var(--color-text-light);
	padding: 1px 4px;
	border: 1px solid color-mix(in srgb, var(--color-border) 70%, transparent);
	border-radius: 999px;
}

.tree-label-compressed {
	font-size: 8px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	color: var(--color-text-light);
	opacity: 0.7;
}

.tree-label-count {
	font-size: 9px;
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	opacity: 0.65;
}

.tree-node-row.current-version .tree-label-desc,
.tree-node-row.current-version .tree-toggle {
	color: var(--color-surface);
	opacity: 0.8;
}

.tree-node-row.current-version .tree-label-count {
	color: var(--color-surface);
	opacity: 0.75;
}

.tree-node-row.current-version .tree-label-branch {
	color: var(--color-surface);
	border-color: rgba(255, 255, 255, 0.35);
	opacity: 0.8;
}

/* Children container */
.tree-children {
	display: none;
}

.tree-children.expanded {
	display: block;
}

/* Divider */
.registry-divider {
	width: 5px;
	background: var(--color-border);
	flex-shrink: 0;
	cursor: col-resize;
	position: relative;
	transition: background 0.15s;
}

.registry-divider::before {
	content: '';
	position: absolute;
	top: 0;
	bottom: 0;
	left: -4px;
	right: -4px;
	z-index: 1;
}

.registry-divider:hover,
.registry-divider.is-dragging {
	background: var(--color-accent);
}

/* Preview pane (right) */
.registry-preview-pane {
	flex: 1;
	min-width: 0;
	display: flex;
	flex-direction: column;
	overflow: hidden;
	background: var(--color-bg);
}

/* Preview tabs (PC only) */
.registry-preview-tabs {
	display: flex;
	gap: 0;
	border-bottom: 1px solid var(--color-border);
	background: var(--color-surface);
	flex-shrink: 0;
	user-select: none;
}

.registry-tab {
	padding: 6px var(--space-md);
	font-size: 10px;
	font-weight: 600;
	letter-spacing: 0.08em;
	text-transform: uppercase;
	background: none;
	border: none;
	border-bottom: 2px solid transparent;
	cursor: pointer;
	color: var(--color-text-light);
	transition: color 0.15s, border-color 0.15s;
}

.registry-tab:hover {
	color: var(--color-text);
}

.registry-tab.active {
	color: var(--color-text);
	border-bottom-color: var(--color-accent);
}

/* Preview content */
.registry-preview {
	flex: 1;
	overflow: auto;
	padding: var(--space-md);
	font-family: 'Maple Mono NF CL', 'Maple Mono NF CN', 'Maple Mono NF', 'Maple Mono', monospace;
	font-size: 12px;
	line-height: 1.6;
	white-space: pre;
	tab-size: 2;
}

.registry-preview-empty {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 100%;
	color: var(--color-text-light);
	font-family: inherit;
	font-size: 11px;
	letter-spacing: 0.08em;
	text-transform: uppercase;
	white-space: normal;
}

/* JSON syntax highlighting */
.json-key {
	color: var(--color-text);
	font-weight: 600;
}

.json-string {
	color: var(--color-accent);
}

.json-number {
	color: #6B8E7B;
}

.json-boolean,
.json-null {
	color: #B85450;
}

.json-bracket {
	color: var(--color-text-light);
}

.json-line {
	display: block;
}

.json-line-number {
	display: inline-block;
	width: 32px;
	text-align: right;
	margin-right: 12px;
	color: var(--color-text-light);
	opacity: 0.4;
	font-size: 10px;
	user-select: none;
}

/* Diff highlighting */
.diff-added {
	background: rgba(107, 142, 123, 0.15);
}

.diff-removed {
	background: rgba(184, 84, 80, 0.15);
	text-decoration: line-through;
	opacity: 0.7;
}

.diff-header {
	color: var(--color-text-light);
	font-size: 10px;
	letter-spacing: 0.06em;
	text-transform: uppercase;
	padding: var(--space-sm) 0;
	margin-bottom: var(--space-sm);
	border-bottom: 1px solid var(--color-border);
	white-space: normal;
	user-select: none;
}

/* Status bar */
.registry-statusbar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 4px var(--space-md);
	background: var(--color-bg);
	border-top: 1px solid var(--color-border);
	font-size: 9px;
	font-weight: 600;
	letter-spacing: 0.08em;
	text-transform: uppercase;
	color: var(--color-text-light);
	flex-shrink: 0;
	user-select: none;
}

/* Mobile preview overlay (portrait) */
.registry-mobile-preview {
	display: none;
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: var(--color-surface);
	flex-direction: column;
	z-index: 10;
}

.registry-mobile-preview.active {
	display: flex;
}

.registry-mobile-preview-header {
	display: flex;
	align-items: center;
	padding: var(--space-sm) var(--space-md);
	border-bottom: 1px solid var(--color-border);
	gap: var(--space-sm);
	flex-shrink: 0;
}

.registry-back-btn {
	background: none;
	border: none;
	font-size: 14px;
	cursor: pointer;
	color: var(--color-accent);
	padding: 4px 8px;
	font-weight: 600;
}

.registry-mobile-title {
	flex: 1;
	font-size: 11px;
	font-weight: 600;
	letter-spacing: 0.08em;
	text-transform: uppercase;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.registry-goto-btn {
	flex-shrink: 0;
	font-size: 10px;
	padding: 4px 10px;
}

/* ---- Responsive: Portrait mobile ---- */
@media (max-width: 767px) and (orientation: portrait) {
	.registry-container {
		position: relative;
	}

	.registry-body {
		flex-direction: column;
	}

	.registry-tree-pane {
		width: 100%;
		min-width: 0;
		max-width: none;
		border-right: none;
		flex: 1;
	}

	.registry-divider,
	.registry-preview-pane {
		display: none;
	}
}

/* ---- Responsive: Landscape mobile ---- */
@media (max-width: 767px) and (orientation: landscape) and (hover: none) and (pointer: coarse) {
	.registry-tree-pane {
		width: 35%;
		max-width: 280px;
	}

	.registry-preview-tabs {
		display: none;
	}
}

/* ---- Responsive: PC / large screens ---- */
/* @media (min-width: 1024px), (hover: hover) and (pointer: fine) {
	.registry-tree-pane {
		width: 30%;
	}
} */

/* ========================================
   Hidden
   ======================================== */

.drag-import-overlay {
	position: fixed;
	inset: 0;
	display: flex;
	align-items: center;
	justify-content: center;
	padding: var(--space-lg);
	background: rgba(245, 244, 240, 0.82);
	opacity: 0;
	visibility: hidden;
	pointer-events: none;
	z-index: 1800;
	transition: opacity 120ms ease, visibility 120ms ease;
}

.drag-import-overlay-card {
	min-width: min(420px, 100%);
	padding: var(--space-xl);
	border: 2px dashed var(--color-text);
	background: var(--color-surface);
	color: var(--color-text);
	font-size: 14px;
	font-weight: 600;
	letter-spacing: 0.06em;
	text-transform: uppercase;
	text-align: center;
}

body.drag-import-active .drag-import-overlay {
	opacity: 1;
	visibility: visible;
}

#importFile {
	display: none;
}

/* ========================================
   Responsive
   ======================================== */

@media (min-width: 768px) {
	body {
		overflow: hidden;
	}

	.container {
		padding: var(--space-2xl);
		height: 100vh;
		min-height: 100vh;
		height: 100dvh;
		min-height: 100dvh;
		display: flex;
		flex-direction: column;
		overflow: hidden;
	}

	h1 {
		flex-shrink: 0;
	}

	.workspace-layout {
		flex: 1;
		min-height: 0;
	}

	.workspace-left,
	.workspace-right {
		height: 100%;
		max-height: 100%;
		min-height: 0;
		overflow-y: auto;
		overflow-x: hidden;
	}
}

@media (min-width: 768px) {
	.container {
		max-width: 1280px;
	}

	.workspace-layout {
		--layout-divider-width: 12px;
		display: grid;
		grid-template-columns: var(--workspace-left-width, minmax(320px, 1fr)) var(--layout-divider-width) minmax(320px, 1fr);
		align-items: stretch;
		height: 100%;
		min-height: 0;
	}

	.workspace-left {
		grid-column: 1;
		padding-right: var(--space-xl);
		align-self: stretch;
	}

	.workspace-left .data-controls {
		flex-wrap: wrap;
	}

	.layout-divider {
		--layout-divider-line-width: 1px;
		--layout-divider-line-opacity: 0.75;
		display: block;
		grid-column: 2;
		position: relative;
		width: var(--layout-divider-width);
		align-self: stretch;
		cursor: col-resize;
		touch-action: none;
	}

	.layout-divider::before {
		content: '';
		position: absolute;
		top: 0;
		bottom: 0;
		left: 50%;
		width: var(--layout-divider-line-width);
		transform: translateX(-50%);
		background: var(--color-line);
		opacity: var(--layout-divider-line-opacity);
		outline: var(--layout-divider-before-outline-width, 0) solid var(--color-line);
		outline-offset: 0;
		transition: width 0.12s ease, opacity 0.12s ease;
	}

	.layout-divider:hover::before {
		--layout-divider-line-opacity: 0.9;
		--layout-divider-before-outline-width: 2px;
	}

	.layout-divider.is-dragging::before {
		opacity: 1;
	}

	.layout-divider:active::before,
	.layout-divider.is-dragging::before {
		--layout-divider-before-outline-width: 3px;
	}

	.layout-divider.is-dragging {
		--layout-divider-line-width: 2px;
	}

	.layout-divider:focus-visible::before {
		--layout-divider-before-outline-width: 2px;
	}

	.workspace-right {
		grid-column: 3;
		padding-left: var(--space-xl);
		min-width: 0;
		align-self: stretch;
	}
}

body.is-resizing-layout,
body.is-resizing-layout * {
	cursor: col-resize !important;
	user-select: none !important;
}

@media (max-width: 480px) {
	.container {
		padding: var(--space-lg) var(--space-md);
	}

	.form-grid,
	.form-grid-3 {
		grid-template-columns: 1fr;
	}

	.batch-toolbar-label {
		width: 100%;
		margin-bottom: 4px;
	}
}

/* iPad Landscape */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
	.container {
		max-width: 100%;
		padding: var(--space-lg) var(--space-2xl);
	}

	.add-form {
		max-width: 600px;
		margin-left: auto;
		margin-right: auto;
	}
}

/* ========================================
   Touch Optimization
   ======================================== */

@media (hover: none) and (pointer: coarse) {
	button:not(.btn-batch):not(.btn-pronounce):not(.word-actions button) {
		min-height: 40px;
	}

	.word-actions button {
		min-height: 34px;
	}
}

/* ========================================
   Print
   ======================================== */

@media print {
	body {
		background: white;
	}

	.workspace-layout {
		display: block !important;
	}

	.layout-divider {
		display: none !important;
	}

	.workspace-left,
	.workspace-right {
		padding: 0 !important;
	}

	.add-form,
	.data-controls,
	.word-actions,
	.mode-switch {
		display: none;
	}

	.word-item {
		break-inside: avoid;
	}
}
